<?xml version="1.0" encoding="UTF-8" ?>
<openerp>
    <data>
        <template id="attendance_index">
            &lt;!DOCTYPE html&gt;
            <html>
                <head>
                    <!-- 新 Bootstrap 核心 CSS 文件 -->
                    <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap.min.css"/>

                    <!-- 可选的Bootstrap主题文件（一般不用引入） -->
                    <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap-theme.min.css"/>

                    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
                    <script src="/hr_sf/static/src/js/jquery-1.12.1.min.js"></script>

                    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
                    <script src="/hr_sf/static/src/js/bootstrap.min.js"></script>
                </head>
                <body>
                    <div class="container">
                        <div class="page-header">
                            <h1>hr_SF
                                <small>手动上传考勤机产生的xls文件。</small>
                            </h1>
                        </div>
                        <form enctype="multipart/form-data" action="/hr_sf/attendance" method="post">
                            <div class="form-group">
                                <label for="upload_file">xls文件</label>
                                <input type="file" id="upload_file" name="upload_file"/>
                                <!--<p class="help-block">Example block-level help text here.</p>-->
                            </div>
                            <input name="source" value="manual" style="display: none;"/>
                            <button type="submit" class="btn btn-default">上传</button>
                        </form>
                    </div>
                </body>
            </html>
        </template>

        <template id="attendance_upload_finish">
            <!--&lt;!DOCTYPE html&gt;-->
            <!--<html>-->
            <!--<head>-->

            <!--</head>-->
            <!--<body>-->
            <!--upload and import finished-->
            <!--</body>-->
            <!--</html>-->
            <t t-esc="'上传成功了，一共导入%d条记录' % import_count"></t>。
        </template>

        <template id="attendance_per_location">
            &lt;!DOCTYPE html&gt;
            <html>
                <head>
                    <head>
                        <!-- 新 Bootstrap 核心 CSS 文件 -->
                        <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap.min.css"/>

                        <!-- 可选的Bootstrap主题文件（一般不用引入） -->
                        <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap-theme.min.css"/>

                        <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
                        <script src="/hr_sf/static/src/js/jquery-1.12.1.min.js"></script>

                        <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
                        <script src="/hr_sf/static/src/js/bootstrap.min.js"></script>
                    </head>
                </head>
                <body>
                    <div class="header">
                        <div class='header'>

                        </div>
                        <div class='page' style='font-size:16px;'>
                            <div class="container">
                                <h2>每日出缺勤状况表</h2>
                                <div class='row'>
                                    <div class='col-md-2'>出勤日期：</div>
                                    <div class='col-md-2'>
                                        <span>
                                            <t t-esc="date"/>
                                        </span>
                                    </div>
                                    <div class="col-md-4">
                                    </div>
                                    <div class='col-md-2'>列印時間：</div>
                                    <div class='col-md-2'>
                                        <span t-esc="print_time"/>
                                    </div>
                                </div>
                                <div class='row'>
                                    <div class='col-md-2'>員工區間：</div>
                                    <div class='col-md-2'><span/>~
                                        <span/>
                                    </div>
                                    <div class='col-md-2'>廠別代號：</div>
                                    <div class='col-md-2'>
                                        <span>
                                            <t t-esc="location"/>
                                        </span>
                                    </div>
                                    <div class='col-md-2'>
                                        <ul class="list-inline">
                                            <li>頁次：</li>
                                            <li>
                                                <span class="page"/>
                                            </li>
                                            <li>/</li>
                                            <li>
                                                <span class="topage"/>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <br/>
                                <table class="table table-striped table-condensed table-hover">
                                    <thead>
                                        <tr>
                                            <th>部門名稱</th>
                                            <th>員工姓名</th>
                                            <th>狀態</th>
                                            <th>刷卡日期</th>
                                            <th>刷卡時間</th>
                                            <th>廠別代號</th>
                                            <th>请假</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="emp_attendances" t-as="emp_att">
                                            <tr t-att-class="'danger' if not emp_att['date'] else ''">
                                                <td>
                                                    <span t-esc="emp_att['dep']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['name']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['state']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['date']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['time']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['location']"></span>
                                                </td>
                                                <td>
                                                    <span t-esc="emp_att['leave']"></span>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>

                                </table>
                                <hr style='margin:3px;'/>
                                <div class='row'>
                                    <table style=' border-collapse:collapse;'>
                                        <tr style='background-color:#D8D8D8;'>
                                            <td class='col-xs-1'>總計</td>
                                            <td class='col-xs-2'>打卡人數：</td>
                                            <td class='col-xs-1'>
                                                <span>
                                                    <t t-esc="action_count"/>人
                                                </span>
                                            </td>
                                            <td class='col-xs-2'>未打卡人數：</td>
                                            <td class='col-xs-1'>
                                                <span>
                                                    <t t-esc="un_action_count"/>人
                                                </span>
                                            </td>
                                            <td class='col-xs-2'>請假人數：</td>
                                            <td class='col-xs-1'><span/>人
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </body>
            </html>
        </template>

        <template id="report_web_page_layout">
            &lt;!DOCTYPE html&gt;
            <html>
                <head>
                    <head>
                        <!-- 新 Bootstrap 核心 CSS 文件 -->
                        <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap.min.css"/>

                        <!-- 可选的Bootstrap主题文件（一般不用引入） -->
                        <link rel="stylesheet" href="/hr_sf/static/src/css/bootstrap-theme.min.css"/>

                        <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
                        <script src="/hr_sf/static/src/js/jquery-1.12.1.min.js"></script>

                        <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
                        <script src="/hr_sf/static/src/js/bootstrap.min.js"></script>
                    </head>
                </head>
                <body>
                    <t>
                        <t t-raw="0"></t>
                    </t>
                </body>
            </html>
        </template>

        <template id="attendance_detail_content">
            <div class="header">
                <div class='header'>

                </div>
                <div class='page'>
                    <h2><span/>~<span/>出勤明細表
                    </h2>
                    <div class='row'>
                        <div class='col-xs-3'>標準出勤時間：<span/>~
                            <span/>
                        </div>
                        <div class='col-xs-3'>加班來源：
                            <span>員工出勤 加班單</span>
                        </div>

                        <div class='col-xs-3'>假日出勤：
                            <span>含假日 僅假日</span>
                        </div>
                        <div class='col-xs-2 pull-right'>列印時間：
                            <span t-esc="datetime.date.today()"/>
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-xs-3'>員工區間：<span/>~
                            <span/>
                        </div>
                        <div class='col-xs-3'>請假來源：
                            <span>員工出勤 請假單</span>
                        </div>
                        <div class='col-xs-3'>假別名稱：
                            <span>中文 外文</span>
                        </div>
                        <div class='col-xs-2 pull-right'>
                            <ul class="list-inline">
                                <li>頁次：</li>
                                <li>
                                    <span class="page"/>
                                </li>
                                <li>/</li>
                                <li>
                                    <span class="topage"/>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <table class="table table-bordered">

                        <tr>
                            <td rowspan='2'>部門代號</td>
                            <td rowspan='2'>部門名稱</td>
                            <td rowspan='2'>員工代號</td>
                            <td rowspan='2'>員工姓名</td>
                            <td rowspan='2'>出勤日期</td>

                            <td colspan='3'>實際出勤時間</td>
                            <td colspan='3'>考勤狀況(分)/(次)</td>
                            <td rowspan='2'>加班時數</td>
                            <td rowspan='2'>請假時數</td>
                            <td rowspan='2'>备注</td>
                            <!--<td rowspan='2'>開始時間</td>-->
                            <!--<td rowspan='2'>結束時間</td>-->

                        </tr>
                        <tr>

                            <td>上班</td>
                            <td>下班</td>
                            <td>工時</td>
                            <td>遲到</td>
                            <td>早退</td>
                            <td>忘卡</td>
                        </tr>

                        <t t-foreach="emp_attendances" t-as="emp">
                            <tr>
                                <td>1</td>
                                <td>
                                    <t t-esc="emp['emp_dep']"/>
                                </td>
                                <td>
                                    <t t-esc="emp['emp_code']"/>
                                </td>
                                <td>
                                    <t t-esc="emp['name']"/>
                                </td>
                                <td>
                                    <t t-esc="emp['date']"/>
                                </td>
                                <td>
                                    <t t-esc="emp['start_work_time']"/>
                                </td>
                                <td>
                                    <t t-esc="emp['end_work_time']"/>
                                </td>
                                <td>8</td>
                                <td>
                                    <t t-esc="emp['late_minutes'] or None"/>
                                </td>
                                <td>
                                    <t t-esc="emp['early_minutes'] or None"/>
                                </td>
                                <td>
                                    <t t-esc="emp['forget_card'] or None"/>
                                </td>
                                <td>
                                    <t t-esc="emp['overtime_hours'] or None"/>
                                </td>
                                <td>
                                    <t t-esc="emp['holiday_total'] or None"/>
                                </td>
                                <td>
                                    <t t-esc="emp['summary'] or None"/>
                                </td>
                                <!--<td>15</td>-->
                            </tr>
                        </t>
                    </table>
                </div>
            </div>
        </template>

        <template id="attendance_detail_webpage">
            <t>
                <t t-call="hr_sf.report_web_page_layout">
                    <t t-call="hr_sf.attendance_detail_content"></t>
                </t>
            </t>
        </template>

        <template id="report_attendance_detail">
            <t t-call="report.html_container">
                <t t-call="report.external_layout">
                    <div class="page">
                        <div class="header">
                            <div class='header'>

                            </div>
                            <div class='page'>
                                <h2><span/><t t-esc="'(%s - %s)' %(date_from,date_to)"/><span/>出勤明細表
                                </h2>
                                <div class='row'>
                                    <div class='col-xs-3'>標準出勤時間：<span/>~
                                        <span/>
                                    </div>
                                    <div class='col-xs-3'>加班來源：
                                        <span>員工出勤 加班單</span>
                                    </div>

                                    <div class='col-xs-3'>假日出勤：
                                        <span>含假日 僅假日</span>
                                    </div>
                                    <div class='col-xs-2 pull-right'>列印時間：
                                        <span t-esc="datetime.date.today()"/>
                                    </div>
                                </div>
                                <div class='row'>
                                    <div class='col-xs-3'>員工區間：<span/>~
                                        <span/>
                                    </div>
                                    <div class='col-xs-3'>請假來源：
                                        <span>員工出勤 請假單</span>
                                    </div>
                                    <div class='col-xs-3'>假別名稱：
                                        <span>中文 外文</span>
                                    </div>
                                    <div class='col-xs-2 pull-right'>
                                        <ul class="list-inline">
                                            <li>頁次：</li>
                                            <li>
                                                <span class="page"/>
                                            </li>
                                            <li>/</li>
                                            <li>
                                                <span class="topage"/>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <table class="table table-bordered">

                                    <tr>
                                        <td rowspan='2'>部門代號</td>
                                        <td rowspan='2'>部門名稱</td>
                                        <td rowspan='2'>員工代號</td>
                                        <td rowspan='2'>員工姓名</td>
                                        <td rowspan='2'>出勤日期</td>

                                        <td colspan='3'>實際出勤時間</td>
                                        <td colspan='3'>考勤狀況(分)/(次)</td>
                                        <td rowspan='2'>加班時數</td>
                                        <td rowspan='2'>請假時數</td>
                                        <td rowspan='2'>备注</td>
                                        <!--<td rowspan='2'>開始時間</td>-->
                                        <!--<td rowspan='2'>結束時間</td>-->

                                    </tr>
                                    <tr>

                                        <td>上班</td>
                                        <td>下班</td>
                                        <td>工時</td>
                                        <td>遲到</td>
                                        <td>早退</td>
                                        <td>忘卡</td>
                                    </tr>

                                    <t t-foreach="emp_attendances" t-as="emp">
                                        <tr>
                                            <td>1</td>
                                            <td>
                                                <t t-esc="emp['emp_dep']"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['emp_code']"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['name']"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['date']"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['start_work_time']"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['end_work_time']"/>
                                            </td>
                                            <td>8</td>
                                            <td>
                                                <t t-esc="emp['late_minutes'] or None"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['early_minutes'] or None"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['forget_card'] or None"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['overtime_hours'] or None"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['holiday_total'] or None"/>
                                            </td>
                                            <td>
                                                <t t-esc="emp['summary'] or None"/>
                                            </td>
                                            <!--<td>15</td>-->
                                        </tr>
                                    </t>
                                </table>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </template>
    </data>
</openerp>